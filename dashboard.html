<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
     
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: radial-gradient(circle at 30% 30%, #0f2e2e, #051616);
            background-repeat: no-repeat;
            background-attachment: fixed;
            background-size: cover;
            color: #ffffff;
        }

     

  /* Loading Screen */
        .loading-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 9999;
        }

        .logo {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: rgba(0, 255, 180, 0.05);
            padding: 15px;
            box-shadow: 0 0 25px rgba(0, 255, 180, 0.3);
            animation: pulse 2s infinite ease-in-out;
        }

        .logo img {
            width: 120px;
            height: 120px;
            border-radius: 50%;
        }

        .spinner {
            margin: 20px auto 0;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(0, 255, 180, 0.2);
            border-top: 4px solid #00ffb4;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        .text {
            margin-top: 15px;
            font-size: 1.2rem;
            letter-spacing: 2px;
            color: #00ffb4;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 10px rgba(0, 255, 180, 0.2); }
            50% { box-shadow: 0 0 30px rgba(0, 255, 180, 0.5); }
            100% { box-shadow: 0 0 10px rgba(0, 255, 180, 0.2); }
        }
        
      
        
        
/* Notification Styles */
.notifications {
    display: flex;
    flex-direction: column;
    gap: 20px;
    margin: 20px;
}

.notification {
    background: rgba(15, 46, 46, 0.9);
    border: 2px solid #00ffcc;
    border-radius: 10px;
    padding: 15px;
    color: #ffffff;
    position: relative;
    text-align: center;
}

.notification img {
    width: 30px;
    height: 30px;
    margin: 10px 0;
}

.notification .amount {
    font-size: 1.2em;
    font-weight: bold;
}

.notification .close-btn {
    position: absolute;
    top: 10px;
    right: 10px;
    background: none;
    border: none;
    color: #00ffcc;
    font-size: 1.5em;
    cursor: pointer;
}

/* Footer */
footer {
    position: fixed;
    bottom: 0;
    width: 100%;
    background: rgba(0, 0, 0, 0.0);
    padding: 10px 0;
    display: flex;
    justify-content: center;
    border-top-left-radius: 50px;
border-top-right-radius: 50px;
border-top: 2px solid #00ffcc;
box-shadow: 0 0 10px #00ffcc;
  
}

.footer-menu {
    display: flex;
    justify-content: space-around;
    width: 80%;
}

.footer-icon {
    width: 60px;
    height: 60px;
    cursor: pointer;
    transition: transform 0.3s ease;
}

.footer-icon:hover {
    transform: scale(1.2);
}  


 /* Bonus Icons */
.bonus-section {
    padding: 40px;
    text-align: center;
}

.bonus-icons {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    justify-content: center;
}

.bonus-icon {
    width: 60px;
    height: 60px;
    cursor: pointer;
    transition: transform 0.3s ease;
}

.bonus-icon:hover {
    transform: scale(1.1);
}


/* Countdown */
.countdown-container {
    margin-top: 200px;
    text-align: center;
}

#countdown-btn {
    background-color: #00ffcc;
    border: none;
    padding: 15px 30px;
    font-size: 1.2em;
    border-radius: 10px;
    cursor: not-allowed;
    color: #003333;
}

/* Utility */
.hidden {
    display: none;
}

#mainContent {
    display: block !important;
}

.banner {
            position: relative;
            text-align: center;
        }

        .banner img {
            width: 100%;
            height: auto;
            
            background-size: cover;
    border-bottom: 2px solid #00ffcc; 
    border-bottom-left-radius: 59px;    
    border-bottom-right-radius: 59px;
    
box-shadow: 0 0 10px #00ffcc;
        }


.info-circle {
  position: absolute;
  top: 3px;
  left: 245px;
  width: 80px;
  height: 70px;
  border-radius: 50%;
  font-family: 'Inter', sans-serif;
    background: rgba(15, 23, 42, 0.8);
    
 
  color: #f8fafc;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 15px;
  text-align: center;
  line-height: 1.2; 
  transition: transform 0.3s ease;
  border: 2px solid #00ffcc; 
  box-shadow: 0 0 10px #00ffcc;
}

.info-circle:hover {
  transform: scale(1.05);
}

.info-circle .days {
  font-size: 1.1em;
  font-weight: bold;
  color: #f8fafc;
  margin: 0;
}

.info-circle .found {
  font-size: 13px;
  font-weight: 500;
  color: #f8fafc;
  margin: 4px 0 0 0; 
}

.info-circle .id {
  font-size: 12px;
  color: #f8fafc;
  margin: 2px 0 0 0;
}


@import url('https://fonts.googleapis.com/css2?family=Inter:wght@500;700&display=swap');

.vestbit-info {
    position: absolute;
    top: 80px;
    left: 50px;
    z-index: 99;

    color: #f8fafc;
    padding: 0;            
    border-radius: 0;        
    border: none;           
    backdrop-filter: none;   
    box-shadow: none;        
    background: transparent; 
    font-family: 'Inter', sans-serif;
    line-height: 0.0; 
}

.gima{
    margin: 0.2rem 0;
    font-size: 20px;
    font-weight: 500;
}

.gima2 {
    font-weight: 700;
    color: #22d3ee;
    font-size: 35px;
}

.mine-info {
    position: absolute;
    top: 0px;
    right: 40%;
    font-size: 20px;
    font-weight: bold;
}


.balance-image {
    position: absolute;
    top: 130px;         
    left: 30%;
    width: 3px;
    height: 3px;
                   z-index: 1;
    border-radius: 100%;
    border: 2px solid #00ffcc; 
  box-shadow: 0 0 10px #00ffcc;
}
.balance-info {
    position: absolute;
    top: 180px;        
    left: 38%;
    text-align: center;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    color: #000;
    z-index: 2;
    pointer-events: none;
}

.available-balance {
    font-size: 30px;
    font-weight: bold;
    font-weight: 700;
    margin: 0;
}

.balance-info p:nth-child(2) {
    font-size: 13px;
    font-weight: bold;
    color: #555;
    font-style: italic;
    margin: 0;
}

.timer {
    font-size: 20px;
    Font-weight: bold;
    color: #007bff;
    font-weight: 500;
    margin: 0;
}


 .menu-button {
      position: absolute; 
      top: 20px;
      left: 20px;
      background: #4f46e5;
      color: #fff;
      font-size: 22px;
      padding: 12px 14px;
      border-radius: 12px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      z-index: 1000;
      transition: background 0.3s ease;
      border: 1px solid #00ffc8;
      box-shadow: 0 0 10px #00ffcc;
    }

   /* Menu container */
    .menu-container {
      position: absolute;
      top: -400px;
      right: 20px;
      width: 260px;
      background: #ffffff;
      border-radius: 16px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.2);
      padding: 20px;
      transition: top 0.4s ease;
      z-index: 999;
       border: 2px solid #00ffc8;
      box-shadow: 0 0 10px #00ffcc;
    }

    .menu-container.active {
      top: 70px;
    }

    /* Menu header */
    .menu-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      font-weight: bold;
      font-size: 18px;
      color: #4f46e5;
    }

    .menu-header i {
      cursor: pointer;
      font-size: 22px;
      color: #333;
    }

    /* Menu list */
    .menu-list {
      list-style: none;
      padding: 0;
    }

    .menu-list li {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px 0;
      cursor: pointer;
      font-size: 16px;
      color: #333;
      transition: background 0.3s;
      border-bottom: 1px solid #eee;
    }

    .menu-list li:hover {
      background: #f0f4ff;
      border-radius: 8px;
      padding-left: 8px;
    }

    .menu-list i {
      font-size: 20px;
      color: #4f46e5;
    }

    /* Styling for the close button */
    #closeMenu {
      font-size: 22px;
      cursor: pointer;
      color: #4f46e5;
    }

    .menu-list a {
      display: flex;
      align-items: center;
      gap: 10px;
      text-decoration: none;
      color: inherit;
      width: 100%;
    }
 

.notifications hidden {
  position: fixed;
    top: 0;
    left: 10px;
    width: 95%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 99999;
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateY(-30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.notifications hidden h2 {
  font-size: 18px;
  margin: 10px 0;
}

.notifications hidden img {
  width: 100%;
  height: 100%;
  border-radius: 6px;
  margin: 10px 0;
}

.notifications hidden .amount {
  font-weight: bold;
  color: #00ffcc;
  margin-bottom: 10px;
  font-size: 16px;
}

.notifications hidden button {
  background-color: #00ffcc;
  color: #0f2e2e;
  border: none;
  padding: 10px 15px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: bold;
  transition: background 0.3s;
  margin-right: 10px;
}

.notifications hidden button:hover {
  background-color: #00e6b3;
}

.notifications hidden .close-btn {
  position: absolute;
  top: 5px;
  right: 10px;
  background: transparent;
  color: #ffffff;
  border: none;
  font-size: 18px;
  cursor: pointer;
}


.notification {
  position: fixed;
  top: 0px;
  right: 10px;
  background: #0f2e2e;
  color: #ffffff;
  border: 2px solid #00ffcc;
  border-radius: 10px;
  padding: 20px;
  box-shadow: 0 0 15px rgba(0, 255, 204, 0.5);
  z-index: 9999;
  width: 300px;
  animation: slideIn 0.4s ease;
  font-family: 'Segoe UI', sans-serif;
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateY(-30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.notification h2 {
  font-size: 18px;
  margin: 10px 0;
}

.notification img {
  width: 100%;
  height: 100%;
  border-radius: 6px;
  margin: 10px 0;
}

.notification .amount {
  font-weight: bold;
  color: #00ffcc;
  margin-bottom: 10px;
  font-size: 16px;
}

.notification button {
  background-color: #00ffcc;
  color: #0f2e2e;
  border: none;
  padding: 10px 15px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: bold;
  transition: background 0.3s;
  margin-right: 10px;
}

.notification button:hover {
  background-color: #00e6b3;
}

.notification .close-btn {
  position: absolute;
  top: 5px;
  right: 10px;
  background: transparent;
  color: #ffffff;
  border: none;
  font-size: 18px;
  cursor: pointer;
}

    </style>
</head>
<body>
      <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="logo">
            <img src="logo.png" alt="Vestinoo Logo">
        </div>
        <div class="spinner"></div>
        <div class="text">Loading Vestinoo...</div>
    </div>
    
    
    <!-- Main Content -->
    <div id="main-content" style="display: none;">
        <!-- Button to open menu -->
<div class="menu-button" id="openMenu">
  <i class="fas fa-bars"></i>
</div>

<!-- Floating menu container -->
<div class="menu-container" id="menuContainer">
  <div class="menu-header">
    <span>Menu</span>
    <i class="fas fa-times" id="closeMenu"></i> 
  </div>
  <ul class="menu-list">
    <li>
      <a href="homepage.html">
        <i class="fas fa-home"></i> Home Page
      </a>
    </li>
    <li>
      <a href="contact.html">
        <i class="fas fa-envelope"></i> Support
      </a>
    </li>
    <li>
      <a href="referral.html">
        <i class="fas fa-user-friends"></i> Referrals
      </a>
    </li>
    <li>
      <a href="payment.html">
        <i class="fas fa-arrow-up"></i> Withdrawal
      </a>
    </li>
    <li>
      <a href="deposit.html">
        <i class="fas fa-arrow-down"></i> Deposit
      </a>
    </li>
      </ul>
  
</div>

<script>
  // Get elements
  const openMenu = document.getElementById('openMenu');
  const closeMenu = document.getElementById('closeMenu');
  const menuContainer = document.getElementById('menuContainer');

  // Open menu
  openMenu.addEventListener('click', () => {
    menuContainer.classList.add('active');
  });

  // Close menu
  closeMenu.addEventListener('click', () => {
    menuContainer.classList.remove('active');
  });
</script>
        
        <!-- Banner Section -->
        <div class="banner">
            <img src="banner3.png" alt="Banner" class="banner-image">
            
            <!-- Circular Info Container -->
            <div class="info-circle">
                <p class="days">0 Days</p>
                <p class="found">Found: $0.00</p>
                <p class="id">ID:</p>
            </div>

           <!-- VestBit Info -->
<div class="vestbit-info">
    <p class="gima">VestBit: <span class="gima2">0.00000</span></p>
    <p>Price: <span>$1.00</span> Mine free views</p>
</div>

            <!-- Mine Info -->
            <div class="mine-info">
                <p>Daily Mine: $0.00</p>
            </div>

          <!-- Balance Image -->
<div class="balance-containe">
    <img src="balance.png" alt="Balance" class="balance-image" style="width: 150px; height: 150px; ">
    <div class="balance-info">
        <p class="available-balance">$0.00</p>
        <p>Available Balance</p>
        <p class="timer">00:00</p>
    </div>
            </div>
        </div>

        <!-- Bonus Icons Section -->
<section id="bonus-section" class="bonus-section hidden">
    <h2>Zabi Rabon ka Free VestBit</h2>
    <div class="bonus-icons">  
        <img src="vestBit1.png" alt="Bonus 1" class="bonus-icon">
        <img src="vestBit2.png" alt="Bonus 2" class="bonus-icon">
        <img src="vestBit3.png" alt="Bonus 3" class="bonus-icon">
        <img src="vestBit4.png" alt="Bonus 4" class="bonus-icon">
        <img src="vestBit5.png" alt="Bonus 5" class="bonus-icon">
        <img src="vestBit6.png" alt="Bonus 6" class="bonus-icon">
    </div>
</section>

<!-- Notification After Selection -->
<div class="notifications hidden" id="notification-container">
    <div class="notification">
        <button class="close-btn" onclick="hideNotification()">✖️</button>
        <h2>Congratulations to your Success VestBit<span id="userFullName">User</span>!</h2>
        <img id="selectedBonusIcon" src="con.png" alt="Selected Bonus">
        <div class="amount" id="bonusAmount">VestBit 0.00000</div>
        <button id="clearBonusBtn">Clear</button>
    </div>
</div>

<!-- Countdown Button -->
<section class="dop">
<div class="countdown-container hidden" id="countdown-container">
    <button id="countdown-btn">Trying 5 mistus </button></section>
</div>


                <!-- Footer -->
        <footer>
    <div class="footer-menu">
        <a href="Withdrawal.html">
            <img src="withdrawal.png" alt="Withdraw" class="footer-icon">
        </a>
        <a href="deposit.html">
            <img src="deposit.png" alt="Deposit" class="footer-icon">
        </a>
        <a href="referral.html">
            <img src="referral.png" alt="Referrals" class="footer-icon">
        </a>
    </div>
</footer>

    </div>
  
<script type="module">
import { app } from './firebase.js';
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-database.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-auth.js";

const db = getDatabase(app);
const auth = getAuth(app);

// Elements
const loadingScreen = document.getElementById("loadingScreen");
const mainContent = document.getElementById('main-content');
const daysElement = document.querySelector('.info-circle .days');
const foundElement = document.querySelector('.info-circle .found');
const idElement = document.querySelector('.info-circle .id');
const vestBitElement = document.querySelector('.vestbit-info span');
const mineElement = document.querySelector('.mine-info p');
const availableBalanceElement = document.querySelector('.balance-info .available-balance');
const timerElement = document.querySelector('.balance-info .timer');
const notificationsContainer = document.querySelector('.notifications');
const clearMineButton = document.createElement('button');
const bonusIcons = document.querySelectorAll('.bonus-icon');
const bonusSection = document.getElementById('bonus-section');
const notificationContainer = document.getElementById('notification-container');
const userFullName = document.getElementById('userFullName');
const selectedBonusIcon = document.getElementById('selectedBonusIcon');
const bonusAmount = document.getElementById('bonusAmount');
const clearBonusBtn = document.getElementById('clearBonusBtn');
const countdownContainer = document.getElementById('countdown-container');
const countdownBtn = document.getElementById('countdown-btn');

let lastSelectedTime = localStorage.getItem('lastSelectedTime');
let timer;

const bonuses = [0.00112, 0.00129, 0.00132, 0.00132, 0.00147, 0.0014, 0.0012];

const plans = [
  { amount: 800, dailyProfit: 30.8, days: 49 },
  { amount: 400, dailyProfit: 16.8, days: 45 },
  { amount: 200, dailyProfit: 8.9, days: 43 },
  { amount: 100, dailyProfit: 4.8, days: 40 },
  { amount: 50, dailyProfit: 2.64, days: 35 },
  { amount: 30, dailyProfit: 1.62, days: 34 },
  { amount: 15, dailyProfit: 0.87, days: 33 },
  { amount: 8, dailyProfit: 0.46, days: 32 },
  { amount: 4, dailyProfit: 0.25, days: 31 },
  { amount: 2, dailyProfit: 0.16, days: 22 }
];

const findPlan = (amount) => plans.find(plan => amount >= plan.amount) || null;

const showLoadingScreen = () => {
  loadingScreen.style.display = 'flex';
  mainContent.style.display = 'none';
};

const hideLoadingScreen = () => {
  setTimeout(() => {
    loadingScreen.style.display = 'none';
    mainContent.style.display = 'block';
  }, 1500);
};

const updateUI = (userData) => {
  const { deposit, depositTime, dailyProfit: originalDailyProfit, vestBit, userBalance, referralBonusLeve1, referralBonussLeve2, wellecomeBonus, vestinooID, email, fullName, lastClaimTime } = userData;

  const now = Date.now();
  const plan = findPlan(deposit);
  let remainingDays = 0;
  if (plan) {
    remainingDays = Math.max(plan.days - (now - depositTime) / (24 * 60 * 60 * 1000), 0);
  }

  let dailyProfit = originalDailyProfit || 0;
  if (plan && remainingDays > 0 && dailyProfit === 0) {
    dailyProfit = plan.dailyProfit;
  }

  const lastClaimElapsed = now - (lastClaimTime || 0);
  if (dailyProfit > 0 && plan && remainingDays > 0 && lastClaimElapsed >= 24 * 60 * 60 * 1000) {
    showClearMineButton(email, dailyProfit);
  }

  if (plan) {
    daysElement.textContent = `${remainingDays.toFixed(0)} Days`;
    foundElement.textContent = `Found: $${deposit.toFixed(2)}`;
  } else {
    daysElement.textContent = `0 Days`;
    foundElement.textContent = `Found: $0.00`;
  }

  idElement.textContent = `ID: ${vestinooID}`;
  vestBitElement.textContent = vestBit.toFixed(5);
  mineElement.textContent = `Daily Mine: $${dailyProfit.toFixed(2)}`;
  availableBalanceElement.textContent = `$${userBalance.toFixed(2)}`;

  const timerDate = new Date(depositTime + 24 * 60 * 60 * 1000 - now);
  timerElement.textContent = `${timerDate.getHours()}:${timerDate.getMinutes().toString().padStart(2, '0')}`;

  if (plan && remainingDays <= 0) {
    clearExpiredPackage(email, fullName, deposit);
  }

  handleNotifications({ wellecomeBonus, referralBonusLeve1, referralBonussLeve2, vestBit, fullName, email });
};

const handleNotifications = ({ wellecomeBonus, referralBonusLeve1, referralBonussLeve2, vestBit, fullName, email }) => {
  notificationsContainer.innerHTML = "";
  if (wellecomeBonus > 0) showNotification(fullName, 'clear your Welcome Bonus', 'bonus.png', wellecomeBonus, () => clearBonus(email, 'wellecomeBonus'));
  if (referralBonusLeve1 > 0) showNotification(fullName, 'Clear your New Level 1 Referral Bonus', 'level1.png', referralBonusLeve1, () => clearBonus(email, 'referralBonusLeve1'));
  if (referralBonussLeve2 > 0) showNotification(fullName, 'Clear Your Level 2 Referral bonus', 'level2.png', referralBonussLeve2, () => clearBonus(email, 'referralBonussLeve2'));
  if (vestBit >= 1) showNotification(fullName, 'You can sell your vestBit coin now', 'con.png', vestBit, () => sellVestBit(email, vestBit));
};

const showNotification = (name, message, img, amount, callback) => {
  const box = document.createElement('div');
  box.className = 'notification';
  box.innerHTML = `
    <button class="close-btn">✖️</button>
    <h2>${name}, ${message}</h2>
    <img src="${img}" alt="${message}">
    <div class="amount">$${amount.toFixed(2)}</div>
    <button>Clear</button>
  `;
  notificationsContainer.appendChild(box);
  box.querySelector('.close-btn').onclick = () => box.remove();
  box.querySelector('button:last-child').onclick = async () => {
  await callback();
  box.remove();
};

const clearBonus = async (email, field) => {
  await fetch("https://vestinooproject.vercel.app/api/userUpdate", {
    method: "POST",
    headers: { "Content-Type": "application/json", "x-api-key": "@haruna66" },
    body: JSON.stringify({ email, [field]: 0 })
  });
};

const sellVestBit = async (email, vestBit) => {
  await fetch("https://vestinooproject.vercel.app/api/userUpdate", {
    method: "POST",
    headers: { "Content-Type": "application/json", "x-api-key": "@haruna66" },
    body: JSON.stringify({ email, vestBit: vestBit.toFixed(5) })
  });
};

const clearExpiredPackage = async (email, fullName, deposit) => {
  await fetch("https://vestinooproject.vercel.app/api/userUpdate", {
    method: "POST",
    headers: { "Content-Type": "application/json", "x-api-key": "@haruna66" },
    body: JSON.stringify({ email, deposit: 0, dailyProfit: 0, depositTime: null })
  });
  showNotification(fullName, "Your package is end days", "end.png", deposit, () => {});
};

const showClearMineButton = (email, dailyProfit) => {
  clearMineButton.textContent = "Clear Daily Mine";
  clearMineButton.classList.add('mine-button');
  mainContent.appendChild(clearMineButton);

  clearMineButton.addEventListener('click', async () => {
    await fetch("https://vestinooproject.vercel.app/api/userUpdate", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "x-api-key": "@haruna66"
      },
      body: JSON.stringify({
        email,
        dailyProfit,
        lastClaimTime: Date.now()
      })
    });
    clearMineButton.style.display = "none";
  });
};

const getRandomBonus = () => bonuses[Math.floor(Math.random() * bonuses.length)];

const sendVestBitBonus = async (email, bonusAmount) => {
  try {
    const response = await fetch("https://bonus-gamma.vercel.app/api/vestBit", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "x-api-key": "@haruna66"
      },
      body: JSON.stringify({ email, bonusAmount })
    });

    if (!response.ok) {
      throw new Error("Bonus sending failed.");
    }
    
    console.log("Bonus sent successfully!");
  } catch (error) {
    console.error("Error:", error);
  }
};


const hideNotification = () => notificationContainer.classList.add('hidden');

bonusIcons.forEach((icon) => {
  icon.onclick = () => {
    const randomBonus = getRandomBonus();
    const email = auth.currentUser?.email;
    if (!email) return;

    // Nuna bayani a cikin notification
    userFullName.textContent = email;
    selectedBonusIcon.src = icon.src;
    bonusAmount.textContent = `VestBit ${randomBonus.toFixed(5)}`;

    // Nuna container
    notificationContainer.classList.remove('hidden');
    bonusSection.classList.add('hidden');
    countdownContainer.classList.remove('hidden');

    // Ajiye lokacin
    lastSelectedTime = Date.now();
    localStorage.setItem('lastSelectedTime', lastSelectedTime);

    // Lokacin da user ya danna Clear
    clearBonusBtn.onclick = async () => {
      await sendVestBitBonus(email, randomBonus); // Tura bonus
      notificationContainer.classList.add('hidden'); // Boye bayanin
      startCountdown(); // Fara sabuwar kirga
    };
  };
});

function startCountdown() {
  clearInterval(timer);
  timer = setInterval(() => {
    const diff = (Date.now() - lastSelectedTime) / 1000;
    const remaining = 5 * 60 - diff; // An sauya daga 3 awa zuwa 5 mintuna
    if (remaining <= 0) {
      clearInterval(timer);
      countdownContainer.classList.add('hidden');
      bonusSection.classList.remove('hidden');
    } else {
      const m = Math.floor(remaining / 60);
      const s = Math.floor(remaining % 60);
      countdownBtn.textContent = `Wait ${m}m ${s}s`; // An cire h don ba a da bukata
    }
  }, 1000);
}

window.onload = () => {
  if (lastSelectedTime) {
    const diff = (Date.now() - lastSelectedTime) / 1000;
    if (diff >= 5 * 60) { // An sauya daga 3 awa zuwa 5 mintuna
      bonusSection.classList.remove('hidden');
      countdownContainer.classList.add('hidden');
    } else {
      bonusSection.classList.add('hidden');
      countdownContainer.classList.remove('hidden');
      startCountdown();
    }
  } else {
    bonusSection.classList.remove('hidden');
  }
};


onAuthStateChanged(auth, (user) => {
  showLoadingScreen();

  if (user) {
    const uid = user.uid;
    const userRef = ref(db, `users/${uid}`);

    onValue(userRef, (snapshot) => {
      const userData = snapshot.val();
      if (userData) {
        updateUI(userData);
      } else {
        console.warn("User data not found in the database.");
      }
      hideLoadingScreen();
    }, (error) => {
      console.error("Error fetching user data:", error);
      hideLoadingScreen();
    });
  } else {
    console.warn("User not authenticated.");
    hideLoadingScreen();
  }
});
}
</script>

</body>
</html>
